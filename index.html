<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MDM Solutions | Faucet Quiz Doge</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
    rel="stylesheet"
  />

  <!-- SDK iklan -->
  <script
    id="libtl-sdk"
    src="https://libtl.com/sdk.js"
    data-zone="9256839"
    data-sdk="show_9256839"
  ></script>

  <style>
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background-image: url("https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHeKnntZCTIkTiWGbzpb3dV2SmQ4IK1PXAT8woPpwpuJ-x7YNag4YjbD11btojiH2VZjj_FfMsAMzmIkXhZlgWnm1aeR3cfWTzlhmdB8EEN-wTHYfeciA28S_KKMuYYSkKJsiTzdmgqE5nAp_6CVRh3Mjwvr-6ENCCDeczhHTmsv7TqJPOMzi_D8dS7VE/s1600/bg%20telegram.jpg");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #2c2c2c;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    .container {
      background: rgba(255, 255, 255, 0.9);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
      max-width: 420px;
      width: 100%;
      text-align: center;
      animation: fadeIn 0.6s ease-in-out;
      backdrop-filter: blur(8px);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      font-size: 1.6rem;
      margin-bottom: 1.2rem;
      color: #229ed9;
    }

    .input-address {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 12px;
      font-size: 1rem;
      margin-bottom: 0.35rem;
    }

    .error-msg {
      margin: 0 0 0.75rem;
      font-size: 0.8rem;
      color: #e53935;
      text-align: left;
    }

    .btn {
      background-color: #229ed9;
      color: white;
      border: none;
      padding: 0.75rem 1.2rem;
      border-radius: 12px;
      font-size: 1rem;
      cursor: pointer;
      margin: 0.5rem;
      transition: background 0.3s, opacity 0.2s;
    }

    .btn:hover {
      background-color: #1a8cbf;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .label {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 0.5rem;
    }

    .label a {
      color: #229ed9;
      text-decoration: none;
    }

    #info-text {
      margin-top: 1rem;
      font-weight: 500;
      color: #333;
    }

    /* Modal Quiz */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: #fff;
      padding: 1.5rem;
      border-radius: 16px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
      text-align: left;
      max-width: 400px;
      width: 90%;
      animation: fadeIn 0.5s ease-in-out;
    }

    .modal-content h3 {
      margin-top: 0;
      color: #229ed9;
    }

    .option {
      display: block;
      background: #f2f2f2;
      padding: 0.75rem;
      margin: 0.5rem 0;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .option:hover {
      background: #e0e0e0;
    }

    .option.correct {
      background-color: #4caf50 !important;
      color: white;
    }

    .option.incorrect {
      background-color: #f44336 !important;
      color: white;
    }

    .options-disabled .option {
      pointer-events: none;
      opacity: 0.9;
    }

    @media (max-width: 480px) {
      .container {
        padding: 1.5rem 1rem;
      }

      .modal-content {
        padding: 1rem;
      }

      h1 {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Faucet Quiz DOGE</h1>

    <input
      class="input-address"
      type="email"
      id="faucetpay-email"
      placeholder="Masukkan email FaucetPay Anda"
      required
    />
    <p id="email-error" class="error-msg"></p>

    <p class="label">
      MIKROWALET:
      <a href="https://faucetpay.io/?r=4861782" target="_blank">MASUK / DAFTAR</a>
    </p>

    <button class="btn" id="claim-button">Klaim Hadiah</button>
    <button class="btn" id="bonus-button">Bonus Hadiah</button>

    <div id="info-text">Hadiah: 0.00000010 DOGE</div>
  </div>

  <div class="modal" id="quiz-modal">
    <div class="modal-content">
      <h3 id="quiz-question">Soal</h3>
      <div id="quiz-options"></div>
    </div>
  </div>

  <script>
    // ====== DOM ELEMENTS ======
    const faucetpayEmailInput = document.getElementById("faucetpay-email");
    const emailError = document.getElementById("email-error");
    const claimButton = document.getElementById("claim-button");
    const bonusButton = document.getElementById("bonus-button");
    const infoText = document.getElementById("info-text");
    const quizModal = document.getElementById("quiz-modal");
    const quizQuestion = document.getElementById("quiz-question");
    const quizOptions = document.getElementById("quiz-options");

    // ====== KONFIGURASI FAUCET ======
    // PENTING: Idealnya API key ini dipindah ke backend (server), bukan di JS.
    const apiKey = "80b67838d4c0fb5f9be8c40cc7b8f99240fb1f3491ac7a2df3a794ae7e970189";
    const paymentAmount = "10";   // 10 satoshi DOGE di FaucetPay
    const currency = "DOGE";

    // ====== STATUS SDK IKLAN ======
    let adSDKLoaded = false;
    const sdkScript = document.getElementById("libtl-sdk");

    sdkScript.addEventListener("load", () => {
      // cek lagi apakah fungsi sudah ada
      if (typeof window.show_9256839 === "function") {
        adSDKLoaded = true;
        console.log("SDK iklan siap digunakan.");
      } else {
        // kadang fungsi dibuat sedikit belakangan, kita cek berkala
        let tries = 0;
        const interval = setInterval(() => {
          if (typeof window.show_9256839 === "function") {
            adSDKLoaded = true;
            console.log("SDK iklan siap (setelah penundaan kecil).");
            clearInterval(interval);
          } else if (tries++ > 20) {
            console.warn("SDK iklan tidak mendefinisikan show_9256839.");
            clearInterval(interval);
          }
        }, 200);
      }
    });

    sdkScript.addEventListener("error", () => {
      console.error("Gagal memuat SDK iklan dari libtl.com");
      adSDKLoaded = false;
    });

    // Fungsi menunggu SDK siap (maksimal timeoutMs)
    function waitForAdSDK(timeoutMs = 5000) {
      return new Promise((resolve, reject) => {
        const start = Date.now();

        (function check() {
          if (typeof window.show_9256839 === "function") {
            adSDKLoaded = true;
            return resolve();
          }
          if (Date.now() - start > timeoutMs) {
            return reject(new Error("SDK iklan tidak siap (timeout)"));
          }
          setTimeout(check, 200);
        })();
      });
    }

    // ====== DATA QUIZ ======
    const questions = [
      { question: "Apa itu Bitcoin?", options: ["Mata uang digital", "Bank online", "Saham", "Aplikasi chatting"], answer: "Mata uang digital" },
      { question: "Siapa pencipta Bitcoin?", options: ["Satoshi Nakamoto", "Elon Musk", "Vitalik Buterin", "Jeff Bezos"], answer: "Satoshi Nakamoto" },
      { question: "Apa jumlah maksimum Bitcoin?", options: ["21 juta", "100 juta", "50 juta", "Tak terbatas"], answer: "21 juta" },
      { question: "Bitcoin diluncurkan pada tahun?", options: ["2009", "2012", "2005", "2010"], answer: "2009" },
      { question: "Simbol resmi Bitcoin adalah?", options: ["BTC", "BCH", "BTX", "BCT"], answer: "BTC" },
      { question: "Apa itu Blockchain?", options: ["Basis data terdistribusi", "Situs web", "Dompet digital", "Token"], answer: "Basis data terdistribusi" },
      { question: "Apa itu altcoin?", options: ["Koin selain Bitcoin", "Koin lama", "Koin palsu", "Koin dari game"], answer: "Koin selain Bitcoin" },
      { question: "NFT adalah singkatan dari...", options: ["Non-Fungible Token", "New Financial Trade", "No Fee Transaction", "Next Future Token"], answer: "Non-Fungible Token" },
      { question: "Dompet kripto disebut juga...", options: ["Wallet", "Safe box", "Tabungan", "Rekening"], answer: "Wallet" },
      { question: "USDT adalah jenis...", options: ["Stablecoin", "NFT", "Meme coin", "Privacy coin"], answer: "Stablecoin" }
      // Kamu bisa mengganti / menambah dengan list panjang punyamu sendiri
    ];

    // ====== FUNGSI BANTU ======
    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    let lastQuestionIndex = -1;
    let isAnswering = false;

    function getRandomQuestion() {
      if (!questions.length) return null;
      let idx;
      do {
        idx = Math.floor(Math.random() * questions.length);
      } while (questions.length > 1 && idx === lastQuestionIndex);
      lastQuestionIndex = idx;
      return questions[idx];
    }

    function setClaimLoading(isLoading) {
      if (isLoading) {
        claimButton.disabled = true;
        claimButton.dataset.originalText = claimButton.textContent;
        claimButton.textContent = "Memproses...";
      } else {
        claimButton.textContent =
          claimButton.dataset.originalText || "Klaim Hadiah";
        claimButton.disabled = false;
      }
    }

    // ====== KIRIM HADIAH KE FAUCETPAY ======
    async function sendFaucetReward(email) {
      try {
        const response = await fetch("https://faucetpay.io/api/v1/send", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({
            api_key: apiKey,
            to: email,
            amount: paymentAmount,
            currency: currency
          })
        });

        const result = await response.json();

        if (response.ok && result.status === 200) {
          alert("Selamat! DOGE berhasil dikirim ke dompet Anda.");
          infoText.textContent =
            "Klaim berhasil! Hadiah: 0.00000010 DOGE. Silakan cek FaucetPay Anda.";
        } else {
          alert("Gagal klaim: " + (result.message || "Coba lagi nanti."));
        }
      } catch (err) {
        console.error(err);
        alert("Kesalahan sistem saat proses klaim.");
      }
    }

    // ====== TAMPILKAN IKLAN, LALU REWARD ======
    async function showAdThenReward(email) {
      setClaimLoading(true);
      try {
        // tunggu SDK ready (maks 5 detik)
        await waitForAdSDK(5000);

        // panggil rewarded interstitial
        const fn = window.show_9256839;
        if (typeof fn !== "function") {
          throw new Error("show_9256839 tidak tersedia meskipun SDK loaded");
        }

        await fn();          // tunggu user menonton iklan
        await sendFaucetReward(email); // kirim hadiah
      } catch (e) {
        console.error(e);
        alert(
          "Iklan belum siap atau diblokir. " +
          "Nonaktifkan AdBlock / cek koneksi, lalu coba lagi."
        );
      } finally {
        setClaimLoading(false);
      }
    }

    // ====== QUIZ ======
    function showQuiz(userEmail) {
      const q = getRandomQuestion();
      if (!q) {
        alert("Soal belum tersedia.");
        return;
      }

      quizQuestion.textContent = q.question;
      quizOptions.innerHTML = "";
      isAnswering = false;

      const shuffledOptions = [...q.options];
      shuffle(shuffledOptions);

      shuffledOptions.forEach((opt) => {
        const div = document.createElement("div");
        div.className = "option";
        div.textContent = opt;
        div.onclick = () => {
          if (isAnswering) return;
          isAnswering = true;
          quizOptions.classList.add("options-disabled");

          if (opt === q.answer) {
            div.classList.add("correct");
            setTimeout(() => {
              quizModal.style.display = "none";
              quizOptions.classList.remove("options-disabled");
              showAdThenReward(userEmail);
            }, 800);
          } else {
            div.classList.add("incorrect");
            setTimeout(() => {
              quizOptions.classList.remove("options-disabled");
              showQuiz(userEmail); // coba soal lain
            }, 800);
          }
        };
        quizOptions.appendChild(div);
      });

      quizModal.style.display = "flex";
    }

    // ====== EVENT HANDLER ======
    claimButton.onclick = () => {
      emailError.textContent = "";
      const email = faucetpayEmailInput.value.trim();

      if (!email) {
        emailError.textContent = "Silakan masukkan email FaucetPay terlebih dahulu.";
        faucetpayEmailInput.focus();
        return;
      }

      if (!isValidEmail(email)) {
        emailError.textContent = "Format email tidak valid.";
        faucetpayEmailInput.focus();
        return;
      }

      showQuiz(email);
    };

    bonusButton.onclick = async () => {
      try {
        await waitForAdSDK(5000);
        const fn = window.show_9256839;
        if (typeof fn !== "function") {
          throw new Error("show_9256839 tidak tersedia.");
        }

        await fn("pop"); // rewarded popup
        alert("Terima kasih telah melihat iklan bonus!");
      } catch (e) {
        console.error(e);
        alert(
          "Iklan bonus belum siap atau diblokir. " +
          "Nonaktifkan AdBlock / cek koneksi, lalu coba lagi."
        );
      }
    };

    faucetpayEmailInput.addEventListener("input", () => {
      emailError.textContent = "";
    });

    // ====== IN-APP INTERSTITIAL OTOMATIS ======
    window.addEventListener("load", async () => {
      try {
        await waitForAdSDK(5000);
        const fn = window.show_9256839;
        if (typeof fn === "function") {
          fn({
            type: "inApp",
            inAppSettings: {
              frequency: 2,
              capping: 0.1,
              interval: 30,
              timeout: 5,
              everyPage: false
            }
          });
        }
      } catch (e) {
        console.warn("In-app interstitial tidak bisa dimuat:", e.message);
      }
    });
  </script>
</body>
</html>
